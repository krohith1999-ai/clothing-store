#!/bin/sh
# Maven Wrapper script for Unix (Linux/macOS). Required for Render and other Linux build environments.

set -e

MAVEN_PROJECTBASEDIR="$(cd "$(dirname "$0")" && pwd)"
MAVEN_WRAPPER_JAR="$MAVEN_PROJECTBASEDIR/.mvn/wrapper/maven-wrapper.jar"
MAVEN_WRAPPER_LAUNCHER=org.apache.maven.wrapper.MavenWrapperMain

if [ ! -f "$MAVEN_WRAPPER_JAR" ]; then
  echo "Downloading Maven Wrapper..."
  mkdir -p "$(dirname "$MAVEN_WRAPPER_JAR")"
  curl -sL -o "$MAVEN_WRAPPER_JAR" \
    "https://repo.maven.apache.org/maven2/org/apache/maven/wrapper/maven-wrapper/3.2.0/maven-wrapper-3.2.0.jar"
  if [ ! -f "$MAVEN_WRAPPER_JAR" ]; then
    echo "Failed to download Maven Wrapper."
    exit 1
  fi
fi

export MAVEN_PROJECTBASEDIR
exec java -Dmaven.multiModuleProjectDirectory="$MAVEN_PROJECTBASEDIR" \
  -cp "$MAVEN_WRAPPER_JAR" \
  "$MAVEN_WRAPPER_LAUNCHER" \
  "$@"
